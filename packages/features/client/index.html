<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      href="https://unpkg.com/bonsai.css@latest/dist/bonsai.min.css"
      rel="stylesheet"
    />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <main style="--p: 1rem">
      <h1>Import Features</h1>

      <hr />

      <h2>Live Binding with Static vs Dynamic imports</h2>

      <div>
        <h5>STATIC</h5>
        <p>Using <code>import { value } from "/module"</code> syntax</p>
        <div>Results: <span id="static"></span></div>
      </div>

      <br />

      <div>
        <h5>DYNAMIC</h5>
        <p>Using <code>import("/module")</code> syntax</p>
        <div>Results: <span id="dynamic"></span></div>
      </div>

      <hr />

      <h2>Import Attributes</h2>

      <button id="importBtn">import</button>

      <div>
        <h5>DEFAULT IMPORT</h5>
        <p>Using unspecified type while importing <i>.json</i> file</p>
        <div>Results: <span id="import"></span></div>
      </div>

      <div>
        <h5>SPECIFIC IMPORT</h5>
        <p>
          Using <code>{with: {type: 'json'}}</code> specifier while importing
          <i>.json</i> file
        </p>
      </div>
      <div>Results: <span id="import-attribute"></span></div>
    </main>

    <script type="module">
      const staticEl = document.querySelector("#static");
      const dynamicEl = document.querySelector("#dynamic");
      const importBtn = document.querySelector("#importBtn");
      const importEl = document.querySelector("#import");
      const importAttrEl = document.querySelector("#import-attribute");

      import { value as staticValue } from "/module";
      const { value: dynamicValue } = await import("/module");

      staticEl.innerHTML = staticValue;
      dynamicEl.innerHTML = dynamicValue;

      setTimeout(() => {
        staticEl.innerHTML = staticValue;
        dynamicEl.innerHTML = dynamicValue;
      }, 1500);

      async function handleClick() {
        import("/data")
          .then((mod) => {
            importEl.innerHTML = JSON.stringify(mod.default);
          })
          .catch((e) => {
            console.error("Unable to import /data", e);
            importEl.innerHTML = `ERROR: ${e.message}`;
          });

        import("/data", { with: { type: "json" } })
          .then((mod) => {
            importAttrEl.innerHTML = JSON.stringify(mod.default);
          })
          .catch((e) => {
            console.error("Unable to import /data", e);
            importAttrEl.innerHTML = `ERROR: ${e.message}`;
          });
      }

      importBtn.addEventListener("click", handleClick);
    </script>
  </body>
</html>
