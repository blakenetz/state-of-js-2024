<!DOCTYPE html>
<html lang="en">
  <body>
    <div>
      <strong>LOADING:</strong>
      <span id="loading">FALSE</span>
    </div>

    <br />

    <div>
      <strong>STATIC:</strong>
      <p>Using <code>import { value } from "/module"</code> syntax</p>
      <div>Results: <span id="static"></span></div>
    </div>

    <br />

    <div>
      <strong>DYNAMIC:</strong>
      <p>Using <code>import("/module")</code> syntax</p>
      <div>Results: <span id="dynamic"></span></div>
    </div>

    <hr />

    <div>
      <strong>IMPORT ATTRIBUTES:</strong>
      <button id="importBtn">import</button>
      <p>import <i>.json</i> file with MIME type <i>application/json</i></p>
      <div>Results: <span id="import"></span></div>
      <p>
        import <i>.json</i> file with MIME type <i>application/json</i> and
        <i>import attribute specifier</i>
      </p>
      <div>Results: <span id="import-attribute"></span></div>
    </div>

    <script type="module">
      const loading = document.querySelector("#loading");
      const staticEl = document.querySelector("#static");
      const dynamicEl = document.querySelector("#dynamic");
      const importBtn = document.querySelector("#importBtn");
      const importEl = document.querySelector("#import");
      const importAttrEl = document.querySelector("#import-attribute");

      loading.innerHTML = "TRUE";

      import { value as staticValue } from "/module";
      const { value: dynamicValue } = await import("/module");

      staticEl.innerHTML = staticValue;
      dynamicEl.innerHTML = dynamicValue;

      setTimeout(() => {
        staticEl.innerHTML = staticValue;
        dynamicEl.innerHTML = dynamicValue;

        loading.innerHTML = "FALSE";
      }, 1500);

      async function handleClick() {
        import("/data")
          .then((mod) => {
            importEl.innerHTML = JSON.stringify(mod.default);
          })
          .catch((e) => {
            console.error("Unable to import /data", e);
            importEl.innerHTML = `ERROR: ${e.message}`;
          });

        import("/data", { with: { type: "json" } })
          .then((mod) => {
            importAttrEl.innerHTML = JSON.stringify(mod.default);
          })
          .catch((e) => {
            console.error("Unable to import /data", e);
            importAttrEl.innerHTML = `ERROR: ${e.message}`;
          });
      }

      importBtn.addEventListener("click", handleClick);
    </script>
  </body>
</html>
